---
title: "STAT 303 Homework 3"
output: html_document
---

We'll grade your homework by

* opening your "hw3.Rmd" file in RStudio
* clicking "Knit HTML"
* reading the HTML output
* reading your "hw3.Rmd"

You should write R code anywhere you see an empty R code chunk. You
should write English text anywhere you see "..."; please surround it
with doubled asterisks (`**...**`) so that it will show up as boldface
and be easy for us to find.

Include reasonable labels (titles, axis labels, legends, etc.) with
each of your graphs.

Name: Svadrut Kukunooru 

Email: kukunooru@wisc.edu

We'll use data on housing values in suburbs of Boston. They are in an
R package called "MASS." (An R package is a collection of code,
data, and documentation. "MASS" refers to the book "Modern Applied
Statistics with S." R developed from the earlier language, S.) The
MASS package comes with the default R installation, so it's already on
your computer.  However, it's not loaded into your R session by
default. So we'll load it via the `require()` command (there's nothing
for you to do here):

```{r}
require("MASS")
```

Run `?Boston` (outside this R Markdown document) to read the help page for the `Boston` data frame.

Convert the `chas` variable to a factor with labels "off" and "on" (referring to the Charles river).

```{r}
Boston$chas = factor(Boston$chas, labels=c("off", "on"))
```

How many rows are in the Boston data frame? How many columns?

```{r}
dim(Boston)
```
506 rows, 14 columns.

What does a row represent?

A suburb of Boston.

What does a column represent?

A property a suburb has, such as median value of owner-occupied homes, or pupil-teacher ratio by town. 

Make a density plot (with rug) of tax rates.

```{r}
library(ggplot2)
ggplot(Boston, aes(x = tax)) +
  geom_density() +         # Add the density plot
  geom_rug() +             # Add rug plots along the x-axis
  labs(x = "Tax",  # Add x-label
       y = "Frequency",  # Add y-label
       title = "Density of Taxes in Boston Suburbs")  # Add title

```

Describe the shape of the distribution of tax rates.

The distribution of tax rates is bimodal. It is asymmetric, with the right peak being smaller than the left peak. It appears that there is two groups of suburbs with similar tax rates. 

Note that the distribution shape doesn't make sense in light of the rug representation of the data. Make a histogram of the tax rates.

```{r}
ggplot(Boston, aes(x = tax)) +
  geom_histogram(binwidth = 50) +
  labs(x = "Tax",  # Add x-label
       y = "Suburbs",  # Add y-label
       title = "Taxes in Boston Suburbs")  # Add title
```

Why is the second peak of the density plot so large? In what way is the rug representation of the data inadequate? Write a line or two of code to figure it out, and then explain it.

```{r}
```

The rug representation of the data is inadequate because it doesn't show when there is many of the exact same value. The first peak matches with the rug plot because it shows that there is values there that eventually increase in density as the plot climbs. However, for the second peak, it just shows one point, which is actually supposed to be many points of the same value.  

Make a barplot of "chas".

```{r}
ggplot(Boston, aes(x=chas)) +
  geom_bar() + 
  labs(x = "On the Charles River?",  # Add x-label
       y = "Suburbs",  # Add y-label
       title = "Suburbs on Charles River")  # Add title + 

```

How many neighborhoods are on the Charles river?

```{r}
sum(Boston$chas == "on")
```

Make a single graph consisting of three plots: 

* a scatterplot of "nox" on the y-axis vs. "dis" on the x-axis 
* a (vertical) boxplot of "nox" left of the scatterplot's y-axis
* a (horizontal) boxplot of "dis" below the scatterplot's x-axis

Hint: use `layout()` with a 4x4 matrix, using the top-right 3x3 corner
for the scatterplot, leaving the bottom-left 1x1 corner blank, and
using the other parts for the boxplots.

(An optional challenge, worth 0 extra credit points: remove the axis
and plot border from each boxplot.)

```{r, fig.width=7, fig.height=7}
layout(matrix(c(1, 2, 3, 4), nrow = 2, ncol = 2))
# Plot 1
boxplot(Boston$nox)

# Plot 3
plot.new()


plot(Boston$dis, Boston$nox)

boxplot(Boston$dis, horizontal = TRUE)

```

Look into the highest-crime neighborhood by making a single graph of one column of three rows:

* Find the row number, r, of the neighborhood with the highest "crim".
* Make a density plot of "crim". Include a rug to show the data.
* Add a red circle at (x, y) = (max crime rate, 0) to make this maximum crime rate stand out.
* Make a density plot with rug of "medv", adding a red circle at (x, y) = (medv[r], 0) to see what medv corresponds to the highest crime rate.
* Repeat the last step for "ptratio".

```{r}
crimMax = max(Boston$crim)
r = which.max(Boston$crim)

layout(matrix(c(1, 2, 3), nrow = 3, ncol = 1))

plot(density(Boston$crim) )
rug(Boston$crim)
points(x=crimMax, y=0, col="red")
plot(density(Boston$medv))
rug(Boston$medv)
points(x=Boston$medv[r], y=0, col="red")
plot(density(Boston$ptratio))
rug(Boston$ptratio)
points(x=Boston$ptratio[r], y=0, col="red")

```

What do you notice about the ptratio and medv for the highest-crime neighborhood?

I notice that the ptratio with max crime rate corresponds strongly with the highest density of ptratio. However, medv with the highest crime rate does not correspond as strongly with the largest density of medv. 
