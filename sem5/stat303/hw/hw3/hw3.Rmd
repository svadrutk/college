```{r}
set.seed(3)
x = c(118, 121, 113, 116, 117, 112, 113)
mu = 119.5
out = t.test(x, mu=119.5)
sigma = sd(x)
n = length(x) # sample size
N = 10000 # number of replicates
t = replicate(N, { x=rnorm(n, mean=mu, sd=sigma); (mean(x) - mu)/(sd(x)/sqrt(n)) })
more.extreme = (abs(t) > abs(out$statistic))
(simulated.p.value = sum(more.extreme) / N)
out$p.value
```